steps:
# # 1. Construir a imagem Docker
# - name: 'gcr.io/cloud-builders/docker'
#   args: ['build', '-f', 'Dockerfile', '-t', 'gcr.io/ventros-ai/health-pg', '.']

# # 2. Enviar a imagem para o Container Registry
# - name: 'gcr.io/cloud-builders/docker'
#   args: ['push', 'gcr.io/ventros-ai/health-pg']

# 3. Implantar no Cloud Run
- name: 'gcr.io/google.com/cloudsdktool/cloud-sdk'
  entrypoint: 'gcloud'
  args: ['run', 'deploy', 'health-pg', 
         '--image', 'gcr.io/ventros-ai/health-pg', 
         '--platform', 'managed', 
         '--region', 'southamerica-east1', 
         '--allow-unauthenticated',
         '--set-env-vars', 'DB_USER=postgres,DB_PASSWORD=Omicron$4474,DB_NAME=postgres,INSTANCE_CONNECTION_NAME=ventros-ai:southamerica-east1:prod-ventros']